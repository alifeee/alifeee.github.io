<!DOCTYPE html>
<html>
<head>
<title>Diplomacy</title>
<style>
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}
th, td {
  padding: 5px;
  text-align: left;
}
a {
  text-decoration: none;
}
.named {
  width : "50px";
  background-color : "red";
}
</style>
</head>

<body style="background-color:#ddffff">
<h1><a href="../" style="text-decoration:underline">alifeee<a></h1>
<h2>Diplomacy Results</h2>

<table id="results"></table>

<script>
var xmlhttp = new XMLHttpRequest();
var lgreen = "#548235";
var red = "#ffc1c1";
var yellow = "#ffe699";
var green = "#c6e0b4";
xmlhttp.onreadystatechange = function () {
  if (this.readyState == 4 && this.status == 200) {
    var games_players = JSON.parse(this.responseText);
    var games = games_players['games'];
    var players = games_players['players'];
    var tab = "";
    
    var headers = "<tr>";
    headers += "<th>Map</th><th>Game</th>";
    for (player in players) {
      headers += "<th>"+player+"</th>";
    }
    headers += "</tr>";
    
    data = "";
    for (game of games) {
      data += "<tr>";
      data += "<td><a href='https://vdiplomacy.com/variants.php?variantID="+game['map']['id']+"'>"+game['map']['name']+"</a></td>";
      if (game['id'] == 256214) {
                data += "<td style='text-align:center'><a href='https://webdiplomacy.net/board.php?gameID="+game['id']+"'><img src='https://alifeee.github.io/diplomacy/vdip.png'></img></a></td>";
      }
      else {
        data += "<td style='text-align:center'><a href='https://vdiplomacy.com/board.php?gameID="+game['id']+"'><img src='https://alifeee.github.io/diplomacy/vdip.png'></img></a></td>";
      }
      for (player in players) {
        var color = ""
        switch(game['results'][player]) {
          case "win": color = lgreen; break;
          case "death": color = red; break;
          case "survive": color = yellow; break;
          case "draw": color = green; break;
          default: color = "blue";
        }
        if (game['results'][player] == undefined) {
          data += "<td>-</td>";
          continue;
        }
        data += "<td style='background-color:"+color+"'>"+game['results'][player]+"</td>";
      }
      data += "</tr>";
    }

    var performance = "<tr>";
    performance += "<td title='10, 5, and 1 points for a win, draw, and survive, divided by total number of games'>Performance</td>"
    performance += "<td>-</td>";
    for (player in players) {
      var score = 0;
      score += players[player]['results']['wins'] * 10;
      score += players[player]['results']['draws'] * 5;
      score += players[player]['results']['survives'] * 1;
      score = score / (players[player]['results']['wins'] + players[player]['results']['draws'] + players[player]['results']['survives'] + players[player]['results']['deaths']);
      score = score.toFixed(2);
      performance += "<td>"+score+"</td>";
    }

    tab += headers;
    tab += data;
    tab += performance;
    var table = document.getElementById("results");
    table.innerHTML = tab;
  }
};
xmlhttp.open("GET", "https://alifeee.github.io/diplomacy/results.json", true);
xmlhttp.send()
</script>

</body>
</html> 














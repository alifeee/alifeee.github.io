<!DOCTYPE html>
<html lang="en">
  <head>
    <title>alifeee</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="icon" href="/favicon.ico" />
    <link rel="stylesheet" href="/stylesheet.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Josefin+Sans|Roboto"
    />

    <!-- alpinejs - https://alpinejs.dev/ -->
    <script src="//unpkg.com/alpinejs" defer></script>

    <!-- anchorjs - https://www.bryanbraun.com/anchorjs/ -->
    <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>

    <!-- relative time -->
    <script>
      function timeSince(date) {
        var seconds = Math.floor((new Date() - date) / 1000);

        var interval = seconds / 31536000;

        if (interval > 1) {
          return Math.floor(interval) + " years";
        }
        interval = seconds / 2592000;
        if (interval > 1) {
          return Math.floor(interval) + " months";
        }
        interval = seconds / 86400;
        if (interval > 1) {
          return Math.floor(interval) + " days";
        }
        interval = seconds / 3600;
        if (interval > 1) {
          return Math.floor(interval) + " hours";
        }
        interval = seconds / 60;
        if (interval > 1) {
          return Math.floor(interval) + " minutes";
        }
        return Math.floor(seconds) + " seconds";
      }
    </script>
  </head>
  <body>
    <header>
      <h1>
        <a href="/">alifeee</a>
      </h1>
    </header>

    <main
      x-data="{data: {}}"
      x-init="fetch('bookmarks.json')
  .then((response) => response.json())
  .then((json) => {
    console.log(json);
    data = json;
  });
  $watch('data', (value) => {
    anchors.add();
  });
  "
    >
      <h1>Bookmarks!</h1>
      <p>Some bookmark collections that I often want to share!</p>
      <h2>Collections</h2>
      <ul>
        <template
          x-for="folder_name in Object.keys(data.bookmarks)"
          :key="folder_name"
        >
          <li>
            <a :href="'#' + folder_name" x-text="folder_name"></a>
          </li>
        </template>
      </ul>
      <template
        x-for="(folder_contents, folder_name) in data.bookmarks"
        :key="folder_name"
      >
        <div id="bookmarks">
          <h2
            :id="folder_name"
            x-text="folder_name"
            x-init="window.location.hash = window.location.hash"
          ></h2>
          <ul>
            <template x-for="bookmark in folder_contents" :key="bookmark.url">
              <li>
                <a :href="bookmark.url" target="_blank">
                  <span x-text="bookmark.title"></span>
                </a>
              </li>
            </template>
          </ul>
        </div>
      </template>
      <hr />
      <span style="display: flex; justify-content: center">
        Updated (when I remember it) by&nbsp;
        <a href="https://github.com/alifeee/firefox-bookmarks" target="_blank">
          <code>firefox-bookmarks</code>
        </a>
      </span>
      <span style="display: flex; justify-content: center">
        Last updated:&nbsp;
        <time
          x-text="timeSince(Date.parse(data.last_modified)) + ' ago'"
        ></time>
      </span>
    </main>

    <footer>
      <a class="backlink" href="/">Back to main page</a>
    </footer>
  </body>
  <style>
    #bookmarks {
      margin-bottom: 2rem;
    }
    #bookmarks > h2 {
      position: sticky;
      top: 0;
      background-color: var(--background);
      padding: 0.5rem;
      text-align: center;
      border-bottom: 1px solid var(--text);
    }
  </style>
</html>
